{"ast":null,"code":"import { Tree, utils } from 'phylocanvas';\nconst {\n  getPixelRatio\n} = utils.canvas;\nconst DEFAULTS = {\n  active: true\n};\n\nfunction drawRoot() {\n  const cxt = this.canvas;\n  const pixelRatio = getPixelRatio(cxt);\n  cxt.save();\n  cxt.strokeStyle = this.branchColour;\n  cxt.lineWidth = this.lineWidth;\n  let x = (this.offsetx + this.root.centerx * this.zoom / 2) * pixelRatio;\n  let y = (this.offsety + this.root.centery * this.zoom / 2) * pixelRatio;\n\n  if (this.treeType == \"rectangular\" || this.treeType == \"diagonal\") {\n    cxt.beginPath();\n    cxt.moveTo(x, y);\n    cxt.lineTo(x - 50, y);\n    cxt.stroke();\n    cxt.closePath();\n  } else if (this.treeType == \"hierarchical\") {\n    cxt.beginPath();\n    cxt.moveTo(x, y);\n    cxt.lineTo(x, y - 50);\n    cxt.stroke();\n    cxt.closePath();\n  }\n\n  cxt.restore();\n}\n\nexport default function plugin(decorate) {\n  decorate(this, 'createTree', (delegate, args) => {\n    const tree = delegate(...args);\n    const [, config = {}] = args;\n    tree.rootLine = Object.assign({}, DEFAULTS, config.rootLine || {});\n    return tree;\n  });\n  decorate(Tree, 'draw', function (delegate, args) {\n    delegate.apply(this, args);\n\n    if (this.rootLine.active) {\n      drawRoot.apply(this);\n    }\n  });\n}","map":{"version":3,"sources":["/var/www/epitools/my_modules/phylocanvas-plugin-root/index.js"],"names":["Tree","utils","getPixelRatio","canvas","DEFAULTS","active","drawRoot","cxt","pixelRatio","save","strokeStyle","branchColour","lineWidth","x","offsetx","root","centerx","zoom","y","offsety","centery","treeType","beginPath","moveTo","lineTo","stroke","closePath","restore","plugin","decorate","delegate","args","tree","config","rootLine","Object","assign","apply"],"mappings":"AAAA,SAASA,IAAT,EAAeC,KAAf,QAA4B,aAA5B;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAoBD,KAAK,CAACE,MAAhC;AAEA,MAAMC,QAAQ,GAAG;AACfC,EAAAA,MAAM,EAAE;AADO,CAAjB;;AAIA,SAASC,QAAT,GAAoB;AAElB,QAAMC,GAAG,GAAG,KAAKJ,MAAjB;AACA,QAAMK,UAAU,GAAGN,aAAa,CAACK,GAAD,CAAhC;AAEAA,EAAAA,GAAG,CAACE,IAAJ;AAEAF,EAAAA,GAAG,CAACG,WAAJ,GAAkB,KAAKC,YAAvB;AACAJ,EAAAA,GAAG,CAACK,SAAJ,GAAgB,KAAKA,SAArB;AAEA,MAAIC,CAAC,GAAG,CAAC,KAAKC,OAAL,GAAgB,KAAKC,IAAL,CAAUC,OAAX,GAAsB,KAAKC,IAA3B,GAAkC,CAAlD,IAAuDT,UAA/D;AACA,MAAIU,CAAC,GAAG,CAAC,KAAKC,OAAL,GAAgB,KAAKJ,IAAL,CAAUK,OAAX,GAAsB,KAAKH,IAA3B,GAAkC,CAAlD,IAAuDT,UAA/D;;AAEA,MAAI,KAAKa,QAAL,IAAiB,aAAjB,IAAkC,KAAKA,QAAL,IAAiB,UAAvD,EAAmE;AACjEd,IAAAA,GAAG,CAACe,SAAJ;AACAf,IAAAA,GAAG,CAACgB,MAAJ,CAAWV,CAAX,EAAcK,CAAd;AACAX,IAAAA,GAAG,CAACiB,MAAJ,CAAWX,CAAC,GAAC,EAAb,EAAiBK,CAAjB;AACAX,IAAAA,GAAG,CAACkB,MAAJ;AACAlB,IAAAA,GAAG,CAACmB,SAAJ;AACD,GAND,MAMO,IAAI,KAAKL,QAAL,IAAiB,cAArB,EAAqC;AAC1Cd,IAAAA,GAAG,CAACe,SAAJ;AACAf,IAAAA,GAAG,CAACgB,MAAJ,CAAWV,CAAX,EAAcK,CAAd;AACAX,IAAAA,GAAG,CAACiB,MAAJ,CAAWX,CAAX,EAAcK,CAAC,GAAC,EAAhB;AACAX,IAAAA,GAAG,CAACkB,MAAJ;AACAlB,IAAAA,GAAG,CAACmB,SAAJ;AACD;;AAEDnB,EAAAA,GAAG,CAACoB,OAAJ;AACD;;AAED,eAAe,SAASC,MAAT,CAAgBC,QAAhB,EAA0B;AACvCA,EAAAA,QAAQ,CAAC,IAAD,EAAO,YAAP,EAAqB,CAACC,QAAD,EAAWC,IAAX,KAAoB;AAC/C,UAAMC,IAAI,GAAGF,QAAQ,CAAC,GAAGC,IAAJ,CAArB;AACA,UAAM,GAAIE,MAAM,GAAG,EAAb,IAAoBF,IAA1B;AACAC,IAAAA,IAAI,CAACE,QAAL,GAAgBC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBhC,QAAlB,EAA4B6B,MAAM,CAACC,QAAP,IAAmB,EAA/C,CAAhB;AACA,WAAOF,IAAP;AACD,GALO,CAAR;AAMAH,EAAAA,QAAQ,CAAC7B,IAAD,EAAO,MAAP,EAAe,UAAU8B,QAAV,EAAoBC,IAApB,EAA0B;AAC/CD,IAAAA,QAAQ,CAACO,KAAT,CAAe,IAAf,EAAqBN,IAArB;;AACA,QAAI,KAAKG,QAAL,CAAc7B,MAAlB,EAA0B;AACxBC,MAAAA,QAAQ,CAAC+B,KAAT,CAAe,IAAf;AACD;AACF,GALO,CAAR;AAMD","sourcesContent":["import { Tree, utils } from 'phylocanvas';\n\nconst { getPixelRatio } = utils.canvas;\n\nconst DEFAULTS = {\n  active: true,\n};\n\nfunction drawRoot() {\n\n  const cxt = this.canvas;\n  const pixelRatio = getPixelRatio(cxt);\n\n  cxt.save();\n\n  cxt.strokeStyle = this.branchColour;\n  cxt.lineWidth = this.lineWidth;\n\n  let x = (this.offsetx + (this.root.centerx) * this.zoom / 2) * pixelRatio\n  let y = (this.offsety + (this.root.centery) * this.zoom / 2) * pixelRatio\n\n  if (this.treeType == \"rectangular\" || this.treeType == \"diagonal\") {\n    cxt.beginPath();\n    cxt.moveTo(x, y);\n    cxt.lineTo(x-50, y);\n    cxt.stroke();\n    cxt.closePath();\n  } else if (this.treeType == \"hierarchical\") {\n    cxt.beginPath();\n    cxt.moveTo(x, y);\n    cxt.lineTo(x, y-50);\n    cxt.stroke();\n    cxt.closePath();\n  }\n\n  cxt.restore();\n}\n\nexport default function plugin(decorate) {\n  decorate(this, 'createTree', (delegate, args) => {\n    const tree = delegate(...args);\n    const [ , config = {} ] = args;\n    tree.rootLine = Object.assign({}, DEFAULTS, config.rootLine || {});\n    return tree;\n  });\n  decorate(Tree, 'draw', function (delegate, args) {\n    delegate.apply(this, args);\n    if (this.rootLine.active) {\n      drawRoot.apply(this);\n    }\n  });\n}\n"]},"metadata":{},"sourceType":"module"}